<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Flood Zone Test Properties</title>
    <script src="core/data-manager.js"></script>
    <script src="shared-data-adapter.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: #0a1628;
            color: white;
            padding: 40px;
            max-width: 1000px;
            margin: 0 auto;
        }
        .container {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
        }
        button {
            background: linear-gradient(135deg, #0066CC, #00D4FF);
            border: none;
            color: white;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1em;
            cursor: pointer;
            margin: 10px;
            width: calc(50% - 20px);
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 212, 255, 0.4);
        }
        .result {
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            max-height: 400px;
            overflow-y: auto;
        }
        .success { color: #10b981; }
        .error { color: #ef4444; }
        .property-card {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        .property-card h3 {
            margin-top: 0;
            color: #00D4FF;
        }
    </style>
</head>
<body>
    <h1>üåä Add Flood Zone Test Properties</h1>
    <p>Add multiple test properties with known flood zones for FEMA API validation</p>

    <div class="container">
        <div class="property-card">
            <h3>1. New Orleans French Quarter (DEFINITELY Flood Zone A/AE)</h3>
            <p><strong>Address:</strong> 632 Bourbon St, New Orleans, LA 70130</p>
            <p><strong>Elevation:</strong> ~1 foot above sea level (high flood risk)</p>
            <p><strong>Coordinates:</strong> 29.9584, -90.0644</p>
            <p><strong>Expected Zone:</strong> A or AE (100-year floodplain)</p>
        </div>
        <button onclick="addNewOrleansProperty()">Add New Orleans Property</button>

        <div class="property-card">
            <h3>2. Miami Beach Oceanfront (DEFINITELY Flood Zone VE)</h3>
            <p><strong>Address:</strong> 1500 Ocean Dr, Miami Beach, FL 33139</p>
            <p><strong>Elevation:</strong> ~6 feet (coastal high velocity zone)</p>
            <p><strong>Coordinates:</strong> 25.7826, -80.1341</p>
            <p><strong>Expected Zone:</strong> VE (coastal high hazard)</p>
        </div>
        <button onclick="addMiamiProperty()">Add Miami Beach Property</button>

        <div class="property-card">
            <h3>3. Phoenix Desert (DEFINITELY Zone X)</h3>
            <p><strong>Address:</strong> 1234 E Camelback Rd, Phoenix, AZ 85016</p>
            <p><strong>Elevation:</strong> ~1,200 feet (desert, no flood risk)</p>
            <p><strong>Coordinates:</strong> 33.5095, -112.0466</p>
            <p><strong>Expected Zone:</strong> X (minimal hazard)</p>
        </div>
        <button onclick="addPhoenixProperty()">Add Phoenix Property</button>

        <div class="property-card">
            <h3>4. Galveston Island Seawall (Flood Zone AE)</h3>
            <p><strong>Address:</strong> 5100 Seawall Blvd, Galveston, TX 77551</p>
            <p><strong>Elevation:</strong> ~8 feet (behind seawall, still flood zone)</p>
            <p><strong>Coordinates:</strong> 29.2733, -94.8300</p>
            <p><strong>Expected Zone:</strong> AE (coastal flood plain)</p>
        </div>
        <button onclick="addGalvestonProperty()">Add Galveston Property</button>
    </div>

    <div class="container">
        <button onclick="addAllProperties()" style="width: 100%; background: linear-gradient(135deg, #10b981, #059669);">
            üöÄ Add ALL 4 Test Properties at Once
        </button>
    </div>

    <div id="result" class="result" style="display:none;"></div>

    <script>
        async function addProperty(propertyData) {
            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'block';

            try {
                await sharedDataAdapter.init();

                const db = await sharedDataAdapter.db;
                const tx = db.transaction('properties', 'readwrite');
                const store = tx.objectStore('properties');

                const existing = await store.get(propertyData.id);
                if (existing) {
                    resultDiv.innerHTML += `<span class="error">‚ö†Ô∏è ${propertyData.basic.address} already exists, updating...</span>\n`;
                }

                await store.put(propertyData);
                await tx.done;

                resultDiv.innerHTML += `<span class="success">‚úÖ Added: ${propertyData.basic.address}</span>\n`;
                resultDiv.innerHTML += `   Expected Zone: ${propertyData.expectedZone}\n`;
                resultDiv.innerHTML += `   Elevation: ${propertyData.location.elevation || 'N/A'} ft\n\n`;

                return true;
            } catch (error) {
                resultDiv.innerHTML += `<span class="error">‚ùå ERROR: ${error.message}</span>\n\n`;
                return false;
            }
        }

        async function addNewOrleansProperty() {
            const property = {
                id: "test_flood_new_orleans",
                source: "flood_zone_test",
                importDate: new Date().toISOString(),
                expectedZone: "A or AE (100-year floodplain)",
                basic: {
                    address: "632 Bourbon St",
                    bedrooms: 3,
                    bathrooms: 2,
                    squareFeet: 1500,
                    lotSize: 2000,
                    yearBuilt: 1890,
                    propertyType: "Single Family",
                    description: "TEST PROPERTY - New Orleans French Quarter - Below sea level, guaranteed flood zone A/AE",
                    mlsNumber: "TEST_NOLA_001"
                },
                financial: {
                    listingPrice: 450000,
                    daysOnMarket: 0,
                    hoaFees: 0,
                    annualTaxes: 4500,
                    pricePerSqFt: 300
                },
                location: {
                    city: "New Orleans",
                    state: "LA",
                    zipCode: "70130",
                    latitude: 29.9584,
                    longitude: -90.0644,
                    neighborhood: "French Quarter",
                    county: "Orleans",
                    elevation: 1
                },
                features: { parking: "None", cooling: "Window AC", heating: "Gas", fireplace: false, pool: false, stories: 2, basement: false, garage: 0 },
                condition: { overall: "Good", roof: "Fair", foundation: "Fair", lastRenovated: 2010 },
                computed_scores: { overall_score: 70, by_category: { location: { score: 85 }, financial: { score: 65 }, property_physical: { score: 60 } } }
            };
            await addProperty(property);
        }

        async function addMiamiProperty() {
            const property = {
                id: "test_flood_miami_beach",
                source: "flood_zone_test",
                importDate: new Date().toISOString(),
                expectedZone: "VE (Coastal High Velocity)",
                basic: {
                    address: "1500 Ocean Dr",
                    bedrooms: 2,
                    bathrooms: 2,
                    squareFeet: 1200,
                    lotSize: 0,
                    yearBuilt: 1985,
                    propertyType: "Condo",
                    description: "TEST PROPERTY - Miami Beach oceanfront - Coastal high velocity flood zone VE",
                    mlsNumber: "TEST_MIAMI_001"
                },
                financial: {
                    listingPrice: 1200000,
                    daysOnMarket: 0,
                    hoaFees: 800,
                    annualTaxes: 15000,
                    pricePerSqFt: 1000
                },
                location: {
                    city: "Miami Beach",
                    state: "FL",
                    zipCode: "33139",
                    latitude: 25.7826,
                    longitude: -80.1341,
                    neighborhood: "South Beach",
                    county: "Miami-Dade",
                    elevation: 6
                },
                features: { parking: "1-car garage", cooling: "Central AC", heating: "None", fireplace: false, pool: true, stories: 1, basement: false, garage: 1 },
                condition: { overall: "Excellent", roof: "Good", foundation: "Excellent", lastRenovated: 2020 },
                computed_scores: { overall_score: 85, by_category: { location: { score: 95 }, financial: { score: 75 }, property_physical: { score: 85 } } }
            };
            await addProperty(property);
        }

        async function addPhoenixProperty() {
            const property = {
                id: "test_flood_phoenix",
                source: "flood_zone_test",
                importDate: new Date().toISOString(),
                expectedZone: "X (Minimal Flood Hazard)",
                basic: {
                    address: "1234 E Camelback Rd",
                    bedrooms: 4,
                    bathrooms: 3,
                    squareFeet: 2500,
                    lotSize: 8000,
                    yearBuilt: 2015,
                    propertyType: "Single Family",
                    description: "TEST PROPERTY - Phoenix desert - Zone X minimal flood hazard",
                    mlsNumber: "TEST_PHX_001"
                },
                financial: {
                    listingPrice: 650000,
                    daysOnMarket: 0,
                    hoaFees: 150,
                    annualTaxes: 6500,
                    pricePerSqFt: 260
                },
                location: {
                    city: "Phoenix",
                    state: "AZ",
                    zipCode: "85016",
                    latitude: 33.5095,
                    longitude: -112.0466,
                    neighborhood: "Camelback East",
                    county: "Maricopa",
                    elevation: 1200
                },
                features: { parking: "2-car garage", cooling: "Central AC", heating: "Central", fireplace: true, pool: true, stories: 1, basement: false, garage: 2 },
                condition: { overall: "Like New", roof: "New", foundation: "Excellent", lastRenovated: 2015 },
                computed_scores: { overall_score: 80, by_category: { location: { score: 85 }, financial: { score: 75 }, property_physical: { score: 80 } } }
            };
            await addProperty(property);
        }

        async function addGalvestonProperty() {
            const property = {
                id: "test_flood_galveston",
                source: "flood_zone_test",
                importDate: new Date().toISOString(),
                expectedZone: "AE (Coastal Flood Plain)",
                basic: {
                    address: "5100 Seawall Blvd",
                    bedrooms: 3,
                    bathrooms: 2,
                    squareFeet: 1800,
                    lotSize: 3500,
                    yearBuilt: 2005,
                    propertyType: "Single Family",
                    description: "TEST PROPERTY - Galveston Island behind seawall - Flood zone AE",
                    mlsNumber: "TEST_GAL_001"
                },
                financial: {
                    listingPrice: 550000,
                    daysOnMarket: 0,
                    hoaFees: 0,
                    annualTaxes: 7500,
                    pricePerSqFt: 306
                },
                location: {
                    city: "Galveston",
                    state: "TX",
                    zipCode: "77551",
                    latitude: 29.2733,
                    longitude: -94.8300,
                    neighborhood: "Seawall",
                    county: "Galveston",
                    elevation: 8
                },
                features: { parking: "Carport", cooling: "Central AC", heating: "Gas", fireplace: false, pool: false, stories: 2, basement: false, garage: 0 },
                condition: { overall: "Good", roof: "Good", foundation: "Good", lastRenovated: 2018 },
                computed_scores: { overall_score: 70, by_category: { location: { score: 75 }, financial: { score: 70 }, property_physical: { score: 70 } } }
            };
            await addProperty(property);
        }

        async function addAllProperties() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Initializing database...\n\n';

            await addNewOrleansProperty();
            await addMiamiProperty();
            await addPhoenixProperty();
            await addGalvestonProperty();

            resultDiv.innerHTML += '\n<span class="success">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</span>\n';
            resultDiv.innerHTML += '<span class="success">‚úÖ ALL 4 TEST PROPERTIES ADDED!</span>\n\n';
            resultDiv.innerHTML += 'Open Weather Simulator and test each property.\n';
            resultDiv.innerHTML += 'Check browser console for detailed FEMA API logs.\n';
        }

        window.addNewOrleansProperty = addNewOrleansProperty;
        window.addMiamiProperty = addMiamiProperty;
        window.addPhoenixProperty = addPhoenixProperty;
        window.addGalvestonProperty = addGalvestonProperty;
        window.addAllProperties = addAllProperties;
    </script>
</body>
</html>
